    (RQ IN DATE,
                                        BANCI IN VARCHAR,
                                        BANLUCI IN NUMBER,
                                        G1DGSJ IN  DDLUCI.DGSJ%TYPE,
                                        G1DKSJ IN   DDLUCI.DKSJ%TYPE,
                                        G1TZSJ IN   DDLUCI.TZSJ%TYPE,
                                        G1QUCHU IN  DDLUCI.QUCHU%TYPE,
                                        G1FELIANG IN  DDLUCI.FELIANG%TYPE,
                                        G1FEC IN  DDLUCI.FEC%TYPE,
                                        G1FESI IN   DDLUCI.FESI%TYPE,
                                        G1FEMN IN   DDLUCI.FEMN%TYPE,
                                        G1FEP IN   DDLUCI.FEP%TYPE,
                                        G1FES IN   DDLUCI.FES%TYPE,
                                        G1FETI IN   DDLUCI.FETI%TYPE,
                                        G1ZHASIO2 IN   DDLUCI.ZHASIO2%TYPE,
                                        G1ZHACAO IN   DDLUCI.ZHACAO%TYPE,
                                        G1ZHAMGO IN   DDLUCI.ZHAMGO%TYPE,
                                        G1ZHAAL2O3 IN   DDLUCI.ZHAAL2O3%TYPE,
                                        G1ZHAS IN   DDLUCI.ZHAS%TYPE,
                                        G1ZHATIO2 IN   DDLUCI.ZHATIO2%TYPE,
                                        G2DGSJ IN   DDLUCI.DGSJ%TYPE,
                                        G2DKSJ IN   DDLUCI.DKSJ%TYPE,
                                        G2TZSJ IN   DDLUCI.TZSJ%TYPE,
                                        G2QUCHU IN  DDLUCI.QUCHU%TYPE,
                                        G2FELIANG IN   DDLUCI.FELIANG%TYPE,
                                        G2FEC IN   DDLUCI.FEC%TYPE,
                                        G2FESI IN   DDLUCI.FESI%TYPE,
                                        G2FEMN IN   DDLUCI.FEMN%TYPE,
                                        G2FEP IN  DDLUCI.FEP%TYPE,
                                        G2FES IN  DDLUCI.FES%TYPE,
                                        G2FETI IN  DDLUCI.FETI%TYPE,
                                        G2ZHASIO2 IN  DDLUCI.ZHASIO2%TYPE,
                                        G2ZHACAO IN  DDLUCI.ZHACAO%TYPE,
                                        G2ZHAMGO IN  DDLUCI.ZHAMGO%TYPE,
                                        G2ZHAAL2O3 IN  DDLUCI.ZHAAL2O3%TYPE,
                                        G2ZHAS IN  DDLUCI.ZHAS%TYPE,
                                        G2ZHATIO2 IN  DDLUCI.ZHATIO2%TYPE,
                                        G3DGSJ IN   DDLUCI.DGSJ%TYPE,
                                        G3DKSJ IN   DDLUCI.DKSJ%TYPE,
                                        G3TZSJ IN   DDLUCI.TZSJ%TYPE,
                                        G3QUCHU IN  DDLUCI.QUCHU%TYPE,
                                        G3FELIANG IN  DDLUCI.FELIANG%TYPE,
                                        G3FEC IN  DDLUCI.FEC%TYPE,
                                        G3FESI IN  DDLUCI.FESI%TYPE,
                                        G3FEMN IN  DDLUCI.FEMN%TYPE,
                                        G3FEP IN  DDLUCI.FEP%TYPE,
                                        G3FES IN  DDLUCI.FES%TYPE,
                                        G3FETI IN  DDLUCI.FETI%TYPE,
                                        G3ZHASIO2 IN  DDLUCI.ZHASIO2%TYPE,
                                        G3ZHACAO IN  DDLUCI.ZHACAO%TYPE,
                                        G3ZHAMGO IN  DDLUCI.ZHAMGO%TYPE,
                                        G3ZHAAL2O3 IN  DDLUCI.ZHAAL2O3%TYPE,
                                        G3ZHAS IN  DDLUCI.ZHAS%TYPE,
                                        G3ZHATIO2 IN  DDLUCI.ZHATIO2%TYPE,
                                        G4DGSJ IN  DDLUCI.DGSJ%TYPE,
                                        G4DKSJ IN  DDLUCI.DKSJ%TYPE,
                                        G4TZSJ IN  DDLUCI.TZSJ%TYPE,
                                        G4QUCHU IN  DDLUCI.QUCHU%TYPE,
                                        G4FELIANG IN  DDLUCI.FELIANG%TYPE,
                                        G4FEC IN  DDLUCI.FEC%TYPE,
                                        G4FESI IN  DDLUCI.FESI%TYPE,
                                        G4FEMN IN  DDLUCI.FEMN%TYPE,
                                        G4FEP IN  DDLUCI.FEP%TYPE,
                                        G4FES IN  DDLUCI.FES%TYPE,
                                        G4FETI IN  DDLUCI.FETI%TYPE,
                                        G4ZHASIO2 IN  DDLUCI.ZHASIO2%TYPE,
                                        G4ZHACAO IN  DDLUCI.ZHACAO%TYPE,
                                        G4ZHAMGO IN  DDLUCI.ZHAMGO%TYPE,
                                        G4ZHAAL2O3 IN  DDLUCI.ZHAAL2O3%TYPE,
                                        G4ZHAS IN  DDLUCI.ZHAS%TYPE,
                                        G4ZHATIO2 IN  DDLUCI.ZHATIO2%TYPE,
                                        G5DGSJ IN  DDLUCI.DGSJ%TYPE,
                                        G5DKSJ IN  DDLUCI.DKSJ%TYPE,
                                        G5TZSJ IN  DDLUCI.TZSJ%TYPE,
                                        G5QUCHU IN  DDLUCI.QUCHU%TYPE,
                                        G5FELIANG IN  DDLUCI.FELIANG%TYPE,
                                        G5FEC IN  DDLUCI.FEC%TYPE,
                                        G5FESI IN  DDLUCI.FESI%TYPE,
                                        G5FEMN IN  DDLUCI.FEMN%TYPE,
                                        G5FEP IN  DDLUCI.FEP%TYPE,
                                        G5FES IN  DDLUCI.FES%TYPE,
                                        G5FETI IN  DDLUCI.FETI%TYPE,
                                        G5ZHASIO2 IN  DDLUCI.ZHASIO2%TYPE,
                                        G5ZHACAO IN  DDLUCI.ZHACAO%TYPE,
                                        G5ZHAMGO IN  DDLUCI.ZHAMGO%TYPE,
                                        G5ZHAAL2O3 IN  DDLUCI.ZHAAL2O3%TYPE,
                                        G5ZHAS IN  DDLUCI.ZHAS%TYPE,
                                        G5ZHATIO2 IN  DDLUCI.ZHATIO2%TYPE
)
IS
vZDSJ DATE;
vZDSJ2 DATE;
vFENLEI VARCHAR(20);
BEGIN
IF (BANCI='夜班') THEN
    vZDSJ:=RQ+NUMTODSINTERVAL(BANLUCI*80-50,'MINUTE');
END IF;
IF (BANCI='白班') THEN
    vZDSJ:=RQ+NUMTODSINTERVAL((BANLUCI+6)*80-50,'MINUTE');
END IF;
IF (BANCI='中班') THEN
    vZDSJ:=RQ+NUMTODSINTERVAL((BANLUCI+12)*80-50,'MINUTE');
END IF;
vZDSJ2 :=vZDSJ+NUMTODSINTERVAL(40,'MINUTE');

--分类L04,L08,L10,Z14,Z18,Z22,Z26
IF G1FESI IS NULL THEN
vFENLEI:=null;
ELSIF G1FESI <=0.45 THEN
vFENLEI:='L04';
ELSIF G1FESI<=0.85 THEN
vFENLEI:='L08';
ELSIF G1FESI<=1.25 THEN
vFENLEI:='L10';
ELSIF G1FESI<1.6 THEN
vFENLEI:='Z14';
ELSIF G1FESI<=2.0 THEN
vFENLEI:='Z18';
ELSIF G1FESI<=2.4 THEN
vFENLEI:='Z22';
ELSE
vFENLEI:='Z26';
END IF;

UPDATE DDLUCI
SET   DGSJ =G1DGSJ, DKSJ =G1DKSJ,TZSJ =G1TZSJ, QUCHU =G1QUCHU, FELIANG =G1FELIANG,
      FEC =G1FEC,FESI =G1FESI, FEMN =G1FEMN, FES =G1FES, FEP =G1FEP, FETI =G1FETI,
      ZHASIO2 =G1ZHASIO2, ZHACAO =G1ZHACAO, ZHAMGO =G1ZHAMGO,ZHAAL2O3 =G1ZHAAL2O3, ZHAS =G1ZHAS,ZHATIO2=G1ZHATIO2,
      FENLEI=vFENLEI
WHERE (ZDSJ=vZDSJ AND GAOLU=1);
IF SQL%NOTFOUND THEN
INSERT INTO DDLUCI
      (GAOLU, ZDSJ, DGSJ, DKSJ, TZSJ, QUCHU, FELIANG,
       FEC, FESI, FEMN, FEP,FES, FETI,
        ZHASIO2, ZHACAO, ZHAMGO, ZHAAL2O3, ZHAS,ZHATIO2,BANCI,BANLUCI)
VALUES (1, vZDSJ, G1DGSJ, G1DKSJ, G1TZSJ, G1QUCHU, G1FELIANG,
        G1FEC, G1FESI,G1FEMN, G1FEP, G1FES, G1FETI, 
        G1ZHASIO2, G1ZHACAO, G1ZHAMGO, G1ZHAAL2O3, G1ZHAS,G1ZHATIO2,BANCI,BANLUCI);
END IF;
UPDATE DDLUCI a SET LUCI=TO_CHAR((SELECT COUNT(*)+100000000 FROM DDLUCI WHERE ZDSJ<a.ZDSJ AND GAOLU=1 AND DKSJ IS NOT NULL)) WHERE DKSJ IS NOT NULL AND ZDSJ>=vZDSJ AND GAOLU=1;

--分类L04,L08,L10,Z14,Z18,Z22,Z26
IF G2FESI IS NULL THEN
vFENLEI:=null;
ELSIF G1FESI <=0.45 THEN
vFENLEI:='L04';
ELSIF G1FESI<=0.85 THEN
vFENLEI:='L08';
ELSIF G1FESI<=1.25 THEN
vFENLEI:='L10';
ELSIF G1FESI<1.6 THEN
vFENLEI:='Z14';
ELSIF G1FESI<=2.0 THEN
vFENLEI:='Z18';
ELSIF G1FESI<=2.4 THEN
vFENLEI:='Z22';
ELSE
vFENLEI:='Z26';
END IF;
UPDATE DDLUCI
SET    DGSJ =G2DGSJ, DKSJ =G2DKSJ,TZSJ =G2TZSJ, QUCHU =G2QUCHU, FELIANG =G2FELIANG,
        FEC =G2FEC, FESI =G2FESI, FEMN =G2FEMN, FES =G2FES,FEP =G2FEP, FETI =G2FETI, 
        ZHASIO2 =G2ZHASIO2,ZHACAO =G2ZHACAO, ZHAMGO =G2ZHAMGO, ZHAAL2O3 =G2ZHAAL2O3,ZHAS =G2ZHAS,ZHATIO2=G2ZHATIO2,
        FENLEI=vFENLEI
WHERE (ZDSJ=vZDSJ AND GAOLU=2);
IF SQL%NOTFOUND THEN
INSERT INTO DDLUCI
      (GAOLU, ZDSJ, DGSJ, DKSJ, TZSJ,QUCHU, FELIANG,
       FEC, FESI, FEMN, FEP,FES, FETI,
       ZHASIO2, ZHACAO, ZHAMGO, ZHAAL2O3, ZHAS,ZHATIO2,BANCI,BANLUCI)
VALUES (2, vZDSJ, G2DGSJ, G2DKSJ, G2TZSJ, G2QUCHU, G2FELIANG,
       G2FEC, G2FESI,G2FEMN, G2FEP, G2FES, G2FETI,
       G2ZHASIO2, G2ZHACAO, G2ZHAMGO, G2ZHAAL2O3, G2ZHAS,G2ZHATIO2,BANCI,BANLUCI);
END IF;
UPDATE DDLUCI a SET LUCI=TO_CHAR((SELECT COUNT(*)+200000000 FROM DDLUCI WHERE ZDSJ<a.ZDSJ AND GAOLU=2 AND DKSJ IS NOT NULL)) WHERE DKSJ IS NOT NULL AND ZDSJ>=vZDSJ AND GAOLU=2;

--分类L04,L08,L10,Z14,Z18,Z22,Z26
IF G3FESI IS NULL THEN
vFENLEI:=null;
ELSIF G1FESI <=0.45 THEN
vFENLEI:='L04';
ELSIF G1FESI<=0.85 THEN
vFENLEI:='L08';
ELSIF G1FESI<=1.25 THEN
vFENLEI:='L10';
ELSIF G1FESI<1.6 THEN
vFENLEI:='Z14';
ELSIF G1FESI<=2.0 THEN
vFENLEI:='Z18';
ELSIF G1FESI<=2.4 THEN
vFENLEI:='Z22';
ELSE
vFENLEI:='Z26';
END IF;
UPDATE DDLUCI
SET    DGSJ =G3DGSJ, DKSJ =G3DKSJ,TZSJ =G3TZSJ, QUCHU =G3QUCHU, FELIANG =G3FELIANG,
       FEC =G3FEC, FESI =G3FESI, FEMN =G3FEMN, FES =G3FES,FEP =G3FEP, FETI =G3FETI,
       ZHASIO2 =G3ZHASIO2,ZHACAO =G3ZHACAO, ZHAMGO =G3ZHAMGO,ZHAAL2O3 =G3ZHAAL2O3,ZHAS =G3ZHAS,ZHATIO2=G1ZHATIO2,
       FENLEI=vFENLEI
WHERE (ZDSJ=vZDSJ AND GAOLU=3);
IF SQL%NOTFOUND THEN
INSERT INTO DDLUCI
      (GAOLU, ZDSJ, DGSJ, DKSJ, TZSJ,QUCHU,FELIANG, 
       FEC, FESI, FEMN, FEP,FES, FETI, 
       ZHASIO2, ZHACAO, ZHAMGO, ZHAAL2O3, ZHAS,ZHATIO2,BANCI,BANLUCI)
VALUES (3, vZDSJ, G3DGSJ, G3DKSJ, G3TZSJ,G3QUCHU, G3FELIANG,
        G3FEC, G3FESI,G3FEMN, G3FEP, G3FES, G3FETI,
        G3ZHASIO2, G3ZHACAO, G3ZHAMGO, G3ZHAAL2O3, G3ZHAS,G3ZHATIO2,BANCI,BANLUCI);
END IF;
UPDATE DDLUCI a SET LUCI=TO_CHAR((SELECT COUNT(*)+300000000 FROM DDLUCI WHERE ZDSJ<a.ZDSJ AND GAOLU=3 AND DKSJ IS NOT NULL)) WHERE DKSJ IS NOT NULL AND ZDSJ>=vZDSJ AND GAOLU=3;

--分类L04,L08,L10,Z14,Z18,Z22,Z26
IF G4FESI IS NULL THEN
vFENLEI:=null;
ELSIF G1FESI <=0.45 THEN
vFENLEI:='L04';
ELSIF G1FESI<=0.85 THEN
vFENLEI:='L08';
ELSIF G1FESI<=1.25 THEN
vFENLEI:='L10';
ELSIF G1FESI<1.6 THEN
vFENLEI:='Z14';
ELSIF G1FESI<=2.0 THEN
vFENLEI:='Z18';
ELSIF G1FESI<=2.4 THEN
vFENLEI:='Z22';
ELSE
vFENLEI:='Z26';
END IF;
UPDATE DDLUCI
SET    DGSJ =G4DGSJ,DKSJ =G4DKSJ, TZSJ =G4TZSJ, QUCHU =G4QUCHU,FELIANG =G4FELIANG, 
       FEC =G4FEC, FESI =G4FESI,FEMN =G4FEMN, FES =G4FES, FEP =G4FEP,FETI =G4FETI,
       ZHASIO2 =G4ZHASIO2,ZHACAO =G4ZHACAO, ZHAMGO =G4ZHAMGO,ZHAAL2O3 =G4ZHAAL2O3, ZHAS =G4ZHAS,ZHATIO2=G4ZHATIO2,
       FENLEI=vFENLEI
WHERE (ZDSJ=vZDSJ2 AND GAOLU=4);
IF SQL%NOTFOUND THEN
INSERT INTO DDLUCI
      (GAOLU, ZDSJ, DGSJ, DKSJ, TZSJ,QUCHU, FELIANG,
       FEC, FESI, FEMN, FEP,FES, FETI, 
       ZHASIO2, ZHACAO, ZHAMGO, ZHAAL2O3, ZHAS,ZHATIO2,BANCI,BANLUCI)
VALUES ( 4, vZDSJ2, G4DGSJ, G4DKSJ, G4TZSJ,G4QUCHU, G4FELIANG,
        G4FEC, G4FESI,G4FEMN, G4FEP, G4FES, G4FETI,
        G4ZHASIO2, G4ZHACAO, G4ZHAMGO, G4ZHAAL2O3, G4ZHAS,G4ZHATIO2,BANCI,BANLUCI);
END IF;
UPDATE DDLUCI a SET LUCI=TO_CHAR((SELECT COUNT(*)+400000000 FROM DDLUCI WHERE ZDSJ<a.ZDSJ AND GAOLU=4 AND DKSJ IS NOT NULL)) WHERE DKSJ IS NOT NULL AND ZDSJ>=vZDSJ2 AND GAOLU=4;

--分类L04,L08,L10,Z14,Z18,Z22,Z26
IF G5FESI IS NULL THEN
vFENLEI:=null;
ELSIF G1FESI <=0.45 THEN
vFENLEI:='L04';
ELSIF G1FESI<=0.85 THEN
vFENLEI:='L08';
ELSIF G1FESI<=1.25 THEN
vFENLEI:='L10';
ELSIF G1FESI<1.6 THEN
vFENLEI:='Z14';
ELSIF G1FESI<=2.0 THEN
vFENLEI:='Z18';
ELSIF G1FESI<=2.4 THEN
vFENLEI:='Z22';
ELSE
vFENLEI:='Z26';
END IF;
UPDATE DDLUCI
SET    DGSJ =G5DGSJ,DKSJ =G5DKSJ, TZSJ =G5TZSJ,QUCHU =G5QUCHU, FELIANG =G5FELIANG,
       FEC =G5FEC, FESI =G5FESI, FEMN =G5FEMN,FES =G5FES, FEP =G5FEP, FETI =G5FETI,
       ZHASIO2 =G5ZHASIO2, ZHACAO =G5ZHACAO,ZHAMGO =G5ZHAMGO, ZHAAL2O3 =G5ZHAAL2O3,ZHAS =G5ZHAS,ZHATIO2=G5ZHATIO2
WHERE (ZDSJ=vZDSJ2 AND GAOLU=5);
IF SQL%NOTFOUND THEN
INSERT INTO DDLUCI
      (GAOLU, ZDSJ, DGSJ, DKSJ, TZSJ,QUCHU, FELIANG,
       FEC, FESI, FEMN, FEP,FES, FETI,
       ZHASIO2, ZHACAO, ZHAMGO, ZHAAL2O3, ZHAS,ZHATIO2,BANCI,BANLUCI)
VALUES (5, vZDSJ2, G5DGSJ, G5DKSJ, G5TZSJ,G5QUCHU, G5FELIANG,
        G5FEC, G5FESI,G5FEMN, G5FEP, G5FES, G5FETI, 
        G5ZHASIO2, G5ZHACAO, G5ZHAMGO, G5ZHAAL2O3, G5ZHAS,G5ZHATIO2,BANCI,BANLUCI);
END IF;
UPDATE DDLUCI a SET LUCI=TO_CHAR((SELECT COUNT(*)+500000000 FROM DDLUCI WHERE ZDSJ<a.ZDSJ AND GAOLU=5 AND DKSJ IS NOT NULL)) WHERE DKSJ IS NOT NULL AND ZDSJ>=vZDSJ2 AND GAOLU=5;
UPDATE DDLUCI  SET LUCI=null WHERE DKSJ IS NULL AND ZDSJ>=vZDSJ;
EXCEPTION
   WHEN OTHERS THEN
       NULL;
END UPDATELUCI;